<!DOCTYPE HTML> <!-- Created by Naohiro OHTA, All Rights Reserved. -->
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>PhotoShare by Naohiro OHTA</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1/jquery-ui.min.js"></script>
  </head>
  <body>
    <h1>PhotoShare Gallery</h1>
    <h4>各地で撮影された写真です!</h4>
    <div id='photos'><div>
    <script>
      $(function(){
        /*
        $.get('filenames/2013-02',null,function(data){
          var filenames = eval(data);
          console.log(filenames);
        },'json');
        */
        
        var date_str_array = [];
        var period = 6;
        var d = new Date().getTime();
        var end = d - period * (1000*60*60*24);
        for(d; d>end; d=d-(1000*60*60*24)){
          date_str_array.push($.datepicker.formatDate('yy-mm-dd',new Date(d)));
        }
        console.log("date_str_array",date_str_array);
        
        $.each(date_str_array, function(index,date_str){
          $("#photos").append("<hr><h2>"+date_str+"</h2><div id='"+date_str+"'></div>");
          $.get('filenames/'+this, null, function(result){
            var filenames = eval(result);
            console.log("filenames",filenames);
//            var that = date_str;
            $.each(filenames,function(index,filename){
              console.log("filename",filename);
              $("#"+date_str).append("<img src='file/"+filename+"'>");
            });
          },'json');
        });
        
      });
    </script>
  </body>
</html>
